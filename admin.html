<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin - Gerenciar Not√≠cias | GT IoT EDU</title>
  
  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Tailwind Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Lucide (√≠cones SVG) -->
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="bg-slate-900 text-white font-[Inter]">
  
  <!-- NAV -->
  <nav class="flex items-center justify-between px-6 py-4 bg-slate-900/95 backdrop-blur-sm fixed w-full top-0 z-50 border-b border-slate-800">
    <a href="index.html" class="flex items-center space-x-2">
      <div class="relative">
        <i data-lucide="wifi" class="w-8 h-8 text-blue-400"></i>
        <div class="absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-pulse"></div>
      </div>
      <span class="text-xl font-bold">GT IoT EDU</span>
    </a>
    
    <div class="flex items-center space-x-4">
      <span class="text-sm text-slate-400">Admin Panel</span>
      <a href="news.html" class="px-4 py-2 rounded-lg border border-slate-600 text-white hover:bg-slate-800 bg-transparent">Ver Not√≠cias</a>
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="pt-24 pb-16 px-6 min-h-screen">
    <div class="max-w-7xl mx-auto">
      
      <!-- HEADER -->
      <div class="mb-8">
        <h1 class="text-4xl font-bold mb-2 flex items-center gap-3">
          <i data-lucide="settings" class="w-10 h-10 text-blue-400"></i>
          Gerenciar Not√≠cias
        </h1>
        <p class="text-slate-400">Adicione, edite ou remova not√≠cias da landing page</p>
      </div>

      <!-- TABS -->
      <div class="flex gap-2 mb-6 border-b border-slate-700">
        <button id="tab-list" class="px-6 py-3 font-semibold border-b-2 border-blue-400 text-blue-400">
          üìö Listar Not√≠cias
        </button>
        <button id="tab-create" class="px-6 py-3 font-semibold border-b-2 border-transparent hover:border-slate-600 text-slate-400 hover:text-white">
          ‚ûï Nova Not√≠cia
        </button>
      </div>

      <!-- TAB: LISTAR NOT√çCIAS -->
      <div id="content-list" class="tab-content">
        <div class="bg-slate-800 rounded-lg border border-slate-700 p-6">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold flex items-center gap-2">
              <i data-lucide="newspaper" class="w-6 h-6 text-blue-400"></i>
              Not√≠cias Cadastradas
            </h2>
            <button onclick="loadNews()" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center gap-2">
              <i data-lucide="refresh-cw" class="w-4 h-4"></i>
              Atualizar
            </button>
          </div>

          <!-- Loading State -->
          <div id="news-loading" class="text-center py-12 hidden">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400"></div>
            <p class="text-slate-400 mt-4">Carregando not√≠cias...</p>
          </div>

          <!-- News List -->
          <div id="news-list" class="space-y-4"></div>

          <!-- Empty State -->
          <div id="news-empty" class="text-center py-12 hidden">
            <i data-lucide="inbox" class="w-16 h-16 text-slate-600 mx-auto mb-4"></i>
            <p class="text-slate-400">Nenhuma not√≠cia cadastrada</p>
          </div>
        </div>
      </div>

      <!-- TAB: CRIAR/EDITAR NOT√çCIA -->
      <div id="content-create" class="tab-content hidden">
        <div class="bg-slate-800 rounded-lg border border-slate-700 p-6">
          <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i data-lucide="edit" class="w-6 h-6 text-green-400"></i>
            <span id="form-title">Nova Not√≠cia</span>
          </h2>

          <form id="news-form" class="space-y-6">
            <!-- ID -->
            <div>
              <label class="block text-sm font-semibold mb-2">
                ID da Not√≠cia <span class="text-red-400">*</span>
              </label>
              <input type="text" id="article-id" required
                placeholder="Ex: 2025-02-workshop-iot"
                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
              <p class="text-xs text-slate-400 mt-1">Formato: YYYY-MM-nome-curto (ser√° usado como nome do arquivo)</p>
            </div>

            <!-- Data -->
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-semibold mb-2">
                  Data (YYYY-MM) <span class="text-red-400">*</span>
                </label>
                <input type="text" id="article-date" required
                  placeholder="Ex: 2025-02"
                  class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
              </div>
              <div>
                <label class="block text-sm font-semibold mb-2">
                  Data para Exibi√ß√£o <span class="text-red-400">*</span>
                </label>
                <input type="text" id="article-date-display" required
                  placeholder="Ex: Fevereiro 2025"
                  class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
              </div>
            </div>

            <!-- T√≠tulo -->
            <div>
              <label class="block text-sm font-semibold mb-2">
                T√≠tulo <span class="text-red-400">*</span>
              </label>
              <input type="text" id="article-title" required
                placeholder="Ex: Workshop de IoT na Unipampa"
                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
            </div>

            <!-- Descri√ß√£o -->
            <div>
              <label class="block text-sm font-semibold mb-2">
                Descri√ß√£o <span class="text-red-400">*</span>
              </label>
              <textarea id="article-description" required rows="4"
                placeholder="Descri√ß√£o completa da not√≠cia..."
                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white resize-none"></textarea>
            </div>

            <!-- Link -->
            <div>
              <label class="block text-sm font-semibold mb-2">
                Link Externo <span class="text-red-400">*</span>
              </label>
              <input type="url" id="article-link" required
                placeholder="https://exemplo.com"
                class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
            </div>

            <!-- √çcone e Cor -->
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-semibold mb-2">
                  √çcone <span class="text-red-400">*</span>
                </label>
                <select id="article-icon" required
                  class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
                  <option value="book-open">üìñ Livro Aberto (book-open)</option>
                  <option value="graduation-cap">üéì Chap√©u de Formatura (graduation-cap)</option>
                  <option value="handshake">ü§ù Aperto de M√£os (handshake)</option>
                  <option value="flask-conical">üß™ Frasco (flask-conical)</option>
                  <option value="code-2">üíª C√≥digo (code-2)</option>
                  <option value="award">üèÜ Pr√™mio (award)</option>
                  <option value="presentation">üìä Apresenta√ß√£o (presentation)</option>
                  <option value="rocket">üöÄ Foguete (rocket)</option>
                  <option value="beaker">‚öóÔ∏è B√©quer (beaker)</option>
                  <option value="git-branch">üåø Branch Git (git-branch)</option>
                  <option value="newspaper">üì∞ Jornal (newspaper)</option>
                  <option value="users">üë• Usu√°rios (users)</option>
                  <option value="calendar">üìÖ Calend√°rio (calendar)</option>
                  <option value="trophy">üèÜ Trof√©u (trophy)</option>
                  <option value="star">‚≠ê Estrela (star)</option>
                  <option value="zap">‚ö° Raio (zap)</option>
                  <option value="lightbulb">üí° L√¢mpada (lightbulb)</option>
                  <option value="wifi">üì° WiFi (wifi)</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-semibold mb-2">
                  Esquema de Cores <span class="text-red-400">*</span>
                </label>
                <select id="article-color" required
                  class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:outline-none focus:border-blue-400 text-white">
                  <option value="blue">üîµ Azul</option>
                  <option value="green">üü¢ Verde</option>
                  <option value="purple">üü£ Roxo</option>
                  <option value="orange">üü† Laranja</option>
                  <option value="teal">üî∑ Azul-petr√≥leo</option>
                </select>
              </div>
            </div>

            <!-- Tags -->
            <div>
              <label class="block text-sm font-semibold mb-2">
                Tags
              </label>
              <div id="tags-container" class="space-y-3 mb-3"></div>
              <button type="button" onclick="addTag()" 
                class="px-4 py-2 bg-slate-700 hover:bg-slate-600 border border-slate-600 rounded-lg flex items-center gap-2">
                <i data-lucide="plus" class="w-4 h-4"></i>
                Adicionar Tag
              </button>
            </div>

            <!-- Bot√µes -->
            <div class="flex gap-4 pt-4 border-t border-slate-700">
              <button type="submit"
                class="flex-1 px-6 py-3 bg-green-600 hover:bg-green-700 rounded-lg font-semibold flex items-center justify-center gap-2">
                <i data-lucide="save" class="w-5 h-5"></i>
                <span id="btn-save-text">Salvar Not√≠cia</span>
              </button>
              <button type="button" onclick="resetForm()"
                class="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-semibold flex items-center gap-2">
                <i data-lucide="x" class="w-5 h-5"></i>
                Cancelar
              </button>
            </div>
          </form>
        </div>

        <!-- Preview -->
        <div class="bg-slate-800 rounded-lg border border-slate-700 p-6 mt-6">
          <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
            <i data-lucide="eye" class="w-5 h-5 text-purple-400"></i>
            C√≥digo JSON Gerado
          </h3>
          <div class="relative">
            <pre id="json-preview" class="bg-slate-950 rounded-lg p-4 text-sm text-green-400 overflow-x-auto font-mono max-h-96 overflow-y-auto"></pre>
            <button onclick="copyJSON()" 
              class="absolute top-2 right-2 px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-xs flex items-center gap-1">
              <i data-lucide="copy" class="w-3 h-3"></i>
              Copiar
            </button>
          </div>
          <div class="mt-4 flex gap-3">
            <button onclick="downloadArticle()"
              class="px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center gap-2">
              <i data-lucide="download" class="w-4 h-4"></i>
              Baixar JSON
            </button>
            <button onclick="downloadIndex()"
              class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg flex items-center gap-2">
              <i data-lucide="list" class="w-4 h-4"></i>
              Baixar index.json Atualizado
            </button>
          </div>
          <div class="mt-4 p-4 bg-blue-900/20 border border-blue-700/50 rounded-lg">
            <p class="text-sm text-blue-300 flex items-start gap-2">
              <i data-lucide="info" class="w-4 h-4 mt-0.5 flex-shrink-0"></i>
              <span><strong>Como publicar:</strong> Baixe os arquivos JSON e fa√ßa commit na pasta <code class="bg-slate-800 px-1 rounded">news/articles/</code> do reposit√≥rio GitHub. N√£o esque√ßa de atualizar o <code class="bg-slate-800 px-1 rounded">news/index.json</code> tamb√©m!</span>
            </p>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- Toast Notifications -->
  <div id="toast-container" class="fixed bottom-4 right-4 z-50 space-y-2"></div>

  <script>
    let currentEditingFilename = null;
    let allArticles = [];
    let indexData = { articles: [] };

    // Inicializar
    document.addEventListener('DOMContentLoaded', () => {
      if (window.lucide) {
        window.lucide.createIcons();
      }
      
      // Adicionar uma tag padr√£o
      addTag();
      
      // Atualizar preview quando o formul√°rio mudar
      const form = document.getElementById('news-form');
      form.addEventListener('input', updatePreview);
      
      // Carregar not√≠cias
      loadNews();
      
      // Tabs
      document.getElementById('tab-list').addEventListener('click', () => switchTab('list'));
      document.getElementById('tab-create').addEventListener('click', () => switchTab('create'));
    });

    // Switch entre tabs
    function switchTab(tab) {
      const tabs = {
        'list': { button: 'tab-list', content: 'content-list' },
        'create': { button: 'tab-create', content: 'content-create' }
      };

      Object.keys(tabs).forEach(t => {
        const btn = document.getElementById(tabs[t].button);
        const content = document.getElementById(tabs[t].content);
        
        if (t === tab) {
          btn.classList.add('border-blue-400', 'text-blue-400');
          btn.classList.remove('border-transparent', 'text-slate-400');
          content.classList.remove('hidden');
        } else {
          btn.classList.remove('border-blue-400', 'text-blue-400');
          btn.classList.add('border-transparent', 'text-slate-400');
          content.classList.add('hidden');
        }
      });
    }

    // Carregar not√≠cias
    async function loadNews() {
      const loading = document.getElementById('news-loading');
      const list = document.getElementById('news-list');
      const empty = document.getElementById('news-empty');

      loading.classList.remove('hidden');
      list.innerHTML = '';
      empty.classList.add('hidden');

      try {
        // Carregar √≠ndice
        const indexResponse = await fetch('news/index.json');
        indexData = await indexResponse.json();
        
        if (!indexData.articles || indexData.articles.length === 0) {
          loading.classList.add('hidden');
          empty.classList.remove('hidden');
          return;
        }

        // Carregar todas as not√≠cias
        allArticles = await Promise.all(
          indexData.articles.map(async (filename) => {
            try {
              const response = await fetch(`news/articles/${filename}`);
              const article = await response.json();
              return { filename, article };
            } catch (error) {
              console.error(`Erro ao carregar ${filename}:`, error);
              return null;
            }
          })
        );

        allArticles = allArticles.filter(a => a !== null);

        // Renderizar lista
        allArticles.forEach(({ filename, article }) => {
          const card = createArticleCard(filename, article);
          list.appendChild(card);
        });

        loading.classList.add('hidden');
        
        // Reinicializar √≠cones
        if (window.lucide) {
          window.lucide.createIcons();
        }

      } catch (error) {
        console.error('Erro ao carregar not√≠cias:', error);
        loading.classList.add('hidden');
        showToast('Erro ao carregar not√≠cias', 'error');
      }
    }

    // Criar card de artigo
    function createArticleCard(filename, article) {
      const card = document.createElement('div');
      card.className = 'bg-slate-700 rounded-lg p-4 border border-slate-600 hover:border-slate-500 transition-colors';
      
      const colorDot = {
        blue: 'bg-blue-400',
        green: 'bg-green-400',
        purple: 'bg-purple-400',
        orange: 'bg-orange-400',
        teal: 'bg-teal-400'
      }[article.colorScheme] || 'bg-blue-400';

      card.innerHTML = `
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <div class="flex items-center gap-2 mb-2">
              <div class="w-2 h-2 ${colorDot} rounded-full"></div>
              <span class="text-xs text-slate-400">${article.dateDisplay}</span>
              <span class="text-xs text-slate-500">‚Ä¢</span>
              <span class="text-xs text-slate-400">${filename}</span>
            </div>
            <h3 class="font-bold text-lg mb-1">${article.title}</h3>
            <p class="text-sm text-slate-400 line-clamp-2">${article.description}</p>
            <div class="flex gap-2 mt-3">
              ${article.tags.map(tag => `
                <span class="text-xs px-2 py-1 bg-slate-600 rounded">${tag.label}</span>
              `).join('')}
            </div>
          </div>
          <div class="flex gap-2 ml-4">
            <button onclick="editArticle('${filename}')" 
              class="p-2 bg-blue-600 hover:bg-blue-700 rounded" title="Editar">
              <i data-lucide="edit-2" class="w-4 h-4"></i>
            </button>
            <button onclick="deleteArticle('${filename}')" 
              class="p-2 bg-red-600 hover:bg-red-700 rounded" title="Remover">
              <i data-lucide="trash-2" class="w-4 h-4"></i>
            </button>
          </div>
        </div>
      `;
      
      return card;
    }

    // Editar artigo
    function editArticle(filename) {
      const item = allArticles.find(a => a.filename === filename);
      if (!item) return;

      const article = item.article;
      currentEditingFilename = filename;

      // Preencher formul√°rio
      document.getElementById('article-id').value = article.id || '';
      document.getElementById('article-date').value = article.date || '';
      document.getElementById('article-date-display').value = article.dateDisplay || '';
      document.getElementById('article-title').value = article.title || '';
      document.getElementById('article-description').value = article.description || '';
      document.getElementById('article-link').value = article.link || '';
      document.getElementById('article-icon').value = article.icon || 'book-open';
      document.getElementById('article-color').value = article.colorScheme || 'blue';

      // Limpar e adicionar tags
      document.getElementById('tags-container').innerHTML = '';
      article.tags.forEach(tag => {
        addTag(tag.label, tag.icon, tag.color);
      });

      // Atualizar t√≠tulo do formul√°rio
      document.getElementById('form-title').textContent = `Editar: ${filename}`;
      document.getElementById('btn-save-text').textContent = 'Atualizar Not√≠cia';

      // Mudar para aba de criar/editar
      switchTab('create');
      
      // Atualizar preview
      updatePreview();

      showToast('Artigo carregado para edi√ß√£o', 'info');
    }

    // Deletar artigo
    function deleteArticle(filename) {
      if (!confirm(`Tem certeza que deseja remover "${filename}"?\n\nIsso N√ÉO remove o arquivo do GitHub automaticamente. Voc√™ precisar√° fazer o commit da remo√ß√£o manualmente.`)) {
        return;
      }

      // Remover do √≠ndice
      indexData.articles = indexData.articles.filter(f => f !== filename);
      
      // Mostrar novo √≠ndice
      const indexJSON = JSON.stringify(indexData, null, 2);
      
      // Download autom√°tico do novo index
      const blob = new Blob([indexJSON], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'index.json';
      a.click();
      URL.revokeObjectURL(url);

      showToast(`Arquivo removido do √≠ndice. Baixe o novo index.json e delete o arquivo ${filename} do reposit√≥rio.`, 'success');
      
      // Recarregar lista
      loadNews();
    }

    // Adicionar tag
    function addTag(label = '', icon = 'award', color = 'green') {
      const container = document.getElementById('tags-container');
      const tagId = Date.now();
      
      const tagDiv = document.createElement('div');
      tagDiv.className = 'flex gap-2 items-center p-3 bg-slate-700 rounded-lg border border-slate-600';
      tagDiv.id = `tag-${tagId}`;
      
      tagDiv.innerHTML = `
        <input type="text" placeholder="Label da tag" value="${label}"
          class="flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded focus:outline-none focus:border-blue-400 text-white text-sm tag-label">
        <select class="px-3 py-2 bg-slate-800 border border-slate-600 rounded focus:outline-none focus:border-blue-400 text-white text-sm tag-icon">
          <option value="award" ${icon === 'award' ? 'selected' : ''}>üèÜ award</option>
          <option value="presentation" ${icon === 'presentation' ? 'selected' : ''}>üìä presentation</option>
          <option value="users" ${icon === 'users' ? 'selected' : ''}>üë• users</option>
          <option value="calendar" ${icon === 'calendar' ? 'selected' : ''}>üìÖ calendar</option>
          <option value="star" ${icon === 'star' ? 'selected' : ''}>‚≠ê star</option>
          <option value="zap" ${icon === 'zap' ? 'selected' : ''}>‚ö° zap</option>
          <option value="trophy" ${icon === 'trophy' ? 'selected' : ''}>üèÜ trophy</option>
          <option value="newspaper" ${icon === 'newspaper' ? 'selected' : ''}>üì∞ newspaper</option>
        </select>
        <select class="px-3 py-2 bg-slate-800 border border-slate-600 rounded focus:outline-none focus:border-blue-400 text-white text-sm tag-color">
          <option value="green" ${color === 'green' ? 'selected' : ''}>üü¢ verde</option>
          <option value="purple" ${color === 'purple' ? 'selected' : ''}>üü£ roxo</option>
          <option value="blue" ${color === 'blue' ? 'selected' : ''}>üîµ azul</option>
          <option value="teal" ${color === 'teal' ? 'selected' : ''}>üî∑ teal</option>
          <option value="slate" ${color === 'slate' ? 'selected' : ''}>‚ö´ cinza</option>
        </select>
        <button type="button" onclick="removeTag(${tagId})" 
          class="p-2 bg-red-600 hover:bg-red-700 rounded">
          <i data-lucide="x" class="w-4 h-4"></i>
        </button>
      `;
      
      container.appendChild(tagDiv);
      
      // Atualizar √≠cones e preview
      if (window.lucide) {
        window.lucide.createIcons();
      }
      updatePreview();
      
      // Adicionar listener para atualizar preview
      tagDiv.querySelectorAll('input, select').forEach(el => {
        el.addEventListener('input', updatePreview);
      });
    }

    // Remover tag
    function removeTag(tagId) {
      const tag = document.getElementById(`tag-${tagId}`);
      if (tag) {
        tag.remove();
        updatePreview();
      }
    }

    // Coletar dados do formul√°rio
    function collectFormData() {
      const tags = [];
      document.querySelectorAll('#tags-container > div').forEach(tagDiv => {
        const label = tagDiv.querySelector('.tag-label').value.trim();
        const icon = tagDiv.querySelector('.tag-icon').value;
        const color = tagDiv.querySelector('.tag-color').value;
        
        if (label) {
          tags.push({ label, icon, color });
        }
      });

      // Se n√£o houver tags, adicionar uma padr√£o
      if (tags.length === 0) {
        tags.push({
          label: "Not√≠cia",
          icon: "newspaper",
          color: "blue"
        });
      }

      return {
        id: document.getElementById('article-id').value.trim(),
        date: document.getElementById('article-date').value.trim(),
        dateDisplay: document.getElementById('article-date-display').value.trim(),
        title: document.getElementById('article-title').value.trim(),
        description: document.getElementById('article-description').value.trim(),
        link: document.getElementById('article-link').value.trim(),
        icon: document.getElementById('article-icon').value,
        colorScheme: document.getElementById('article-color').value,
        tags
      };
    }

    // Atualizar preview JSON
    function updatePreview() {
      const data = collectFormData();
      const preview = document.getElementById('json-preview');
      preview.textContent = JSON.stringify(data, null, 2);
    }

    // Salvar not√≠cia (submit form)
    document.getElementById('news-form').addEventListener('submit', (e) => {
      e.preventDefault();
      
      const data = collectFormData();
      
      // Validar dados obrigat√≥rios
      if (!data.id || !data.date || !data.dateDisplay || !data.title || !data.description || !data.link) {
        showToast('Preencha todos os campos obrigat√≥rios!', 'error');
        return;
      }

      // Definir filename
      const filename = `${data.id}.json`;
      
      // Atualizar √≠ndice (adicionar no in√≠cio se for novo)
      if (!indexData.articles.includes(filename)) {
        indexData.articles.unshift(filename);
      }

      showToast('JSON gerado! Baixe os arquivos e fa√ßa commit no GitHub.', 'success');
      
      // Scroll para a √°rea de download
      document.getElementById('json-preview').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    });

    // Copiar JSON
    function copyJSON() {
      const preview = document.getElementById('json-preview');
      navigator.clipboard.writeText(preview.textContent).then(() => {
        showToast('JSON copiado para a √°rea de transfer√™ncia!', 'success');
      });
    }

    // Download do artigo
    function downloadArticle() {
      const data = collectFormData();
      const filename = `${data.id}.json`;
      
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = filename;
      a.click();
      URL.revokeObjectURL(url);
      
      showToast(`Arquivo ${filename} baixado!`, 'success');
    }

    // Download do index
    function downloadIndex() {
      const indexJSON = JSON.stringify(indexData, null, 2);
      const blob = new Blob([indexJSON], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'index.json';
      a.click();
      URL.revokeObjectURL(url);
      
      showToast('Arquivo index.json baixado!', 'success');
    }

    // Reset form
    function resetForm() {
      document.getElementById('news-form').reset();
      document.getElementById('tags-container').innerHTML = '';
      addTag();
      currentEditingFilename = null;
      document.getElementById('form-title').textContent = 'Nova Not√≠cia';
      document.getElementById('btn-save-text').textContent = 'Salvar Not√≠cia';
      updatePreview();
      switchTab('list');
    }

    // Toast notifications
    function showToast(message, type = 'info') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      
      const colors = {
        success: 'bg-green-600',
        error: 'bg-red-600',
        info: 'bg-blue-600',
        warning: 'bg-orange-600'
      };
      
      const icons = {
        success: 'check-circle',
        error: 'x-circle',
        info: 'info',
        warning: 'alert-triangle'
      };
      
      toast.className = `${colors[type]} text-white px-6 py-4 rounded-lg shadow-lg flex items-center gap-3 min-w-[300px] animate-slide-in`;
      toast.innerHTML = `
        <i data-lucide="${icons[type]}" class="w-5 h-5"></i>
        <span>${message}</span>
      `;
      
      container.appendChild(toast);
      
      if (window.lucide) {
        window.lucide.createIcons();
      }
      
      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(400px)';
        setTimeout(() => toast.remove(), 300);
      }, 5000);
    }
  </script>

  <style>
    @keyframes slide-in {
      from {
        opacity: 0;
        transform: translateX(400px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .animate-slide-in {
      animation: slide-in 0.3s ease-out;
      transition: all 0.3s ease-out;
    }
    
    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  </style>
</body>
</html>
